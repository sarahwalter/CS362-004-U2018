        -:    0:Source:randomtestcard1.c
        -:    0:Graph:randomtestcard1.gcno
        -:    0:Data:randomtestcard1.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#include "dominion.h"
        -:    2:#include "rngs.h"
        -:    3:#include <stdio.h>
        -:    4:#include <math.h>
        -:    5:#include <stdlib.h>
        -:    6:#include <assert.h>
        -:    7:#include <time.h>
        -:    8:
        -:    9:#define MAX_TESTS 500 
        -:   10:
        -:   11:
function main called 1 returned 100% blocks executed 88%
        1:   12:int main() {
        -:   13:    
        -:   14:    //declare variables
        -:   15:    struct gameState game;
        -:   16:    int players; 
        -:   17:    int player; 
        1:   18:    int k[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
        -:   19:    int seed;  
        -:   20:    int coinBonus;
        -:   21:    int handPos;
        1:   22:    int choice1 = 0;
        1:   23:    int choice2 = 0; 
        1:   24:    int choice3 = 0; 
        1:   25:    int test_failed = 0; 	
        1:   26:    srand(time(NULL));
call    0 returned 100%
call    1 returned 100%
        1:   27:    int test_status = 1; 	
        -:   28:
        1:   29:printf("/*********************** Randomly Testing Smithy Card **************************/\n");
call    0 returned 100%
        -:   30:
      501:   31:    for (int i = 0; i < MAX_TESTS; i++) {
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
        -:   32:
        -:   33:	//randomly initialize variables
      500:   34:        players = rand() % (MAX_PLAYERS - 2) + 2;
call    0 returned 100%
      500:   35:        seed = rand();
call    0 returned 100%
      500:   36:        coinBonus = 0;
      500:   37:        handPos = rand() % 4;
call    0 returned 100%
      500:   38:        player = i % (players);
        -:   39:
      500:   40:        initializeGame(players, k, seed, &game); //initialize game
call    0 returned 100%
        -:   41:
        -:   42:        // Initiate valid state variables
      500:   43:        game.deckCount[player] = rand() % MAX_DECK;   //Pick random deck size out of MAX DECK size
call    0 returned 100%
      500:   44:        game.discardCount[player] = rand() % MAX_DECK;
call    0 returned 100%
      500:   45:        game.handCount[player] = rand() % MAX_HAND;
call    0 returned 100%
        -:   46:       
        -:   47:	//grab hand count numbers before calling the card
      500:   48:	int handCount1 = numHandCards(&game);
call    0 returned 100%
        -:   49: 
        -:   50:	//check if cardEffect is working properly
      500:   51:        if(cardEffect(smithy, choice1, choice2, choice3, &game, 0, 0) == 0){
call    0 returned 100%
branch  1 taken 100% (fallthrough)
branch  2 taken 0%
        -:   52:
        -:   53:	//grab hand count after calling card
      500:   54:	int handCount2 = numHandCards(&game); 
call    0 returned 100%
        -:   55:
        -:   56:		//check to see if hand count changed properly
      500:   57:		if(handCount2 != (handCount1 + 3 - 1)) {
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
      500:   58:			printf("Error: Incorrect number of cards drawn\n"); 	
call    0 returned 100%
      500:   59:			printf("Hand count before: %d. Hand count after %d.\n", handCount1, handCount2 ); 
call    0 returned 100%
      500:   60:			test_failed++; 
      500:   61:			test_status= 0; //set test state to failed
        -:   62:		}
        -:   63:		
        -:   64:	}
        -:   65:	// if card effect failed, print error
        -:   66:	else {
    #####:   67:		printf("Error: card could not be properly played\n"); 
call    0 never executed
    #####:   68:		test_status = 0; //set test state to failed
    #####:   69:		test_failed++; 
        -:   70:	}
        -:   71:
      500:   72:	if(test_status == 0){
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
      500:   73:                printf("Iteration %d: test failed\n", i);
call    0 returned 100%
        -:   74:        }
        -:   75:        else {
    #####:   76:                printf("Iteration %d: test passed \n", i);
call    0 never executed
        -:   77:        }
        -:   78:	
        -:   79:
        -:   80:
        -:   81:    }	
        1:   82:    if(test_failed > 0){
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
        1:   83:	printf("Smithy card failed %d random tests\n", test_failed);	
call    0 returned 100%
        -:   84:    }		
        -:   85:    else {
    #####:   86:	printf("Smithy card passed all random tests\n"); 
call    0 never executed
        -:   87:    }	
        -:   88:
        1:   89:    return 0;
        -:   90:}